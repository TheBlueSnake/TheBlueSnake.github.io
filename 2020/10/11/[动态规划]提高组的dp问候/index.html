<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>[动态规划] 提高组的dp问候 | TheBlueSnake Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 5.0.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 75vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>TheBlueSnake's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('https://i.loli.net/2020/09/04/dkWiupI56tbNMOJ.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.2)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-10-11 20:07">
      2020-10-11 20:07
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      448 字
    </span>
  

  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p><strong>题单地址：</strong><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/training/12927#problems">【动态规划】提高组的DP问候</a></p>
<h3 id="P1880-NOI1995-石子合并"><a href="#P1880-NOI1995-石子合并" class="headerlink" title="P1880 [NOI1995] 石子合并"></a>P1880 [NOI1995] 石子合并</h3><p>标准dp模板题。</p>
<h4 id="状态设计"><a href="#状态设计" class="headerlink" title="状态设计"></a>状态设计</h4><p>先将原串复制一遍，然后<code>f[i][j]</code>表示从<code>i</code>至<code>j</code>之间合并石子的最小得分，<code>g[i][j]</code>表示从<code>i</code>至<code>j</code>之间合并石子的最大得分。</p>
<h4 id="转移方程"><a href="#转移方程" class="headerlink" title="转移方程"></a>转移方程</h4><script type="math/tex; mode=display">
f_{i,j}=\min_{i\leq k< j}\left\{f_{i,k}+f_{k+1,j}\right\}\\
g_{i,j}=\max_{i\leq k< j}\left\{f_{i,k}+f_{k+1,j}\right\}</script><h4 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> INF = <span class="hljs-number">0x3f3f3f3f</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;

<span class="hljs-keyword">int</span> n, cnt[MAXN &lt;&lt; <span class="hljs-number">1</span>], sum[MAXN &lt;&lt; <span class="hljs-number">1</span>];
<span class="hljs-keyword">int</span> f[MAXN &lt;&lt; <span class="hljs-number">1</span>][MAXN &lt;&lt; <span class="hljs-number">1</span>], g[MAXN &lt;&lt; <span class="hljs-number">1</span>][MAXN &lt;&lt; <span class="hljs-number">1</span>];
<span class="hljs-keyword">int</span> ans1, ans2;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;cnt[i]);
        cnt[i + n] = cnt[i];
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= (n &lt;&lt; <span class="hljs-number">1</span>); i++)
        sum[i] = sum[i - <span class="hljs-number">1</span>] + cnt[i];
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(f));
    <span class="hljs-built_in">memset</span>(g, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(g));
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)
        f[i][i] = f[i + n][i + n] = <span class="hljs-number">0</span>,
        g[i][i] = g[i + n][i + n] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span>; j &lt;= n; j++) <span class="hljs-comment">//j length</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + j - <span class="hljs-number">1</span> &lt;= (n &lt;&lt; <span class="hljs-number">1</span>); i++) <span class="hljs-comment">//i start, i + j - 1 end</span>
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = i; k &lt;= i + j - <span class="hljs-number">2</span>; k++) <span class="hljs-comment">//k mid</span>
                f[i][i + j - <span class="hljs-number">1</span>] = min(f[i][i + j - <span class="hljs-number">1</span>], f[i][k] + f[k + <span class="hljs-number">1</span>][i + j - <span class="hljs-number">1</span>] + sum[i + j - <span class="hljs-number">1</span>] - sum[i - <span class="hljs-number">1</span>]),
                g[i][i + j - <span class="hljs-number">1</span>] = max(g[i][i + j - <span class="hljs-number">1</span>], g[i][k] + g[k + <span class="hljs-number">1</span>][i + j - <span class="hljs-number">1</span>] + sum[i + j - <span class="hljs-number">1</span>] - sum[i - <span class="hljs-number">1</span>]);
    ans1 = INF; ans2 = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n - <span class="hljs-number">1</span>; i++)
        ans1 = min(ans1, f[i][i + n - <span class="hljs-number">1</span>]),
        ans2 = max(ans2, g[i][i + n - <span class="hljs-number">1</span>]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n%d\n&quot;</span>, ans1, ans2);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P3146-USACO16OPEN-248-G"><a href="#P3146-USACO16OPEN-248-G" class="headerlink" title="P3146 [USACO16OPEN]248 G"></a>P3146 [USACO16OPEN]248 G</h3><p>下一题的简化版，同样是一眼题，区间dp。</p>
<h4 id="状态设计-1"><a href="#状态设计-1" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j]</code>表示从<code>i</code>至<code>j</code>可以在末尾合并出的最大数。</p>
<h4 id="转移方程-1"><a href="#转移方程-1" class="headerlink" title="转移方程"></a>转移方程</h4><script type="math/tex; mode=display">
f_{i,j}=\max_{i\leq k<j}\left\{\begin{aligned}
&f_{i,k}+1&f_{i,k}=f_{k+1,j}\\
&f_{k+1,j}&f_{i,k}\neq f_{k+1,j}\\
\end{aligned}\right\}</script><h4 id="AC代码-1"><a href="#AC代码-1" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 0x3f3f3f3f</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INFL 0x3f3f3f3f3f3f3f3fll</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">300</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;

<span class="hljs-keyword">int</span> n, arr[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXN], ans;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">int</span> _task = <span class="hljs-number">1</span>; <span class="hljs-comment">//scanf(&quot;%d&quot;, &amp;_task);</span>
    <span class="hljs-keyword">while</span>(_task--)&#123;
        <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[i]);
            ans = max(ans, arr[i]);
        &#125;
        <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(f));
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) f[i][i] = arr[i];
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++)&#123;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j + i - <span class="hljs-number">1</span> &lt;= n; j++)&#123;
                <span class="hljs-keyword">int</span> endpos = j + i - <span class="hljs-number">1</span>;
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = j; k &lt;= endpos - <span class="hljs-number">1</span>; k++)&#123;
                    <span class="hljs-keyword">if</span>(f[j][k] == f[k + <span class="hljs-number">1</span>][endpos])&#123;
                        f[j][endpos] = max(f[j][endpos], f[j][k] == f[k + <span class="hljs-number">1</span>][endpos] ? f[j][k] + <span class="hljs-number">1</span> : f[k + <span class="hljs-number">1</span>][endpos]);
                    &#125;
                &#125;
                ans = max(ans, f[j][endpos]);
            &#125;
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P3147-USACO16OPEN-262144-P"><a href="#P3147-USACO16OPEN-262144-P" class="headerlink" title="P3147 [USACO16OPEN]262144 P"></a>P3147 [USACO16OPEN]262144 P</h3><p>详见<a target="_blank" rel="noopener" href="http://bluesnake.top/2020/09/28/%5BUSACO16OPEN%5D262144P/"><strong>该题的杂题报告</strong></a>。</p>
<h3 id="P3205-HNOI2010-合唱队"><a href="#P3205-HNOI2010-合唱队" class="headerlink" title="P3205 [HNOI2010]合唱队"></a>P3205 [HNOI2010]合唱队</h3><p>可能稍微会想一下，反向思考插入过程，可以认为是一种拆开来的过程，每次只是首或尾才会更新。</p>
<h4 id="状态设计-2"><a href="#状态设计-2" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j][0/1]</code>表示从理想队形<code>i</code>位置至<code>j</code>位置，从首（<code>f[i][j][0]</code>）还是从尾（<code>f[i][j][1]</code>）进入该队伍。</p>
<h4 id="转移方程-2"><a href="#转移方程-2" class="headerlink" title="转移方程"></a>转移方程</h4><p>理想队形第<code>i</code>位表示为<code>a[i]</code></p>
<script type="math/tex; mode=display">
f_{i,j,0}=f_{i+1,j,0}*\left[a_i<a_{i+1}\right]+f_{i+1,j,1}*\left[a_i<a_j\right]\\
f_{i,j,1}=f_{i,j-1,0}*\left[a_i<a_j\right]+f_{i,j-1,1}*\left[a_{j-1}<a_j\right]\\</script><h4 id="AC代码-2"><a href="#AC代码-2" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 0x3f3f3f3f</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INFL 0x3f3f3f3f3f3f3f3fll</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">1100</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MOD = <span class="hljs-number">19650827</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;

<span class="hljs-keyword">int</span> n, arr[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXN][<span class="hljs-number">2</span>];

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">int</span> _task = <span class="hljs-number">1</span>; <span class="hljs-comment">//scanf(&quot;%d&quot;, &amp;_task);</span>
    <span class="hljs-keyword">while</span>(_task--)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[i]);
        &#125;
        <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(f));
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
            f[i][i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
            f[i][i][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
<span class="hljs-comment">//            printf(&quot;:f[%d][%d][0] = %d\n&quot;, i, i, f[i][i][0]);</span>
<span class="hljs-comment">//            printf(&quot;:f[%d][%d][1] = %d\n&quot;, i, i, f[i][i][1]);</span>
        &#125;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++)&#123;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; i + j - <span class="hljs-number">1</span> &lt;= n; j++)&#123;
                <span class="hljs-keyword">int</span> e = i + j - <span class="hljs-number">1</span>;
                f[j][e][<span class="hljs-number">0</span>] = (<span class="hljs-number">1l</span>l * f[j + <span class="hljs-number">1</span>][e][<span class="hljs-number">0</span>] * (arr[j] &lt; arr[j + <span class="hljs-number">1</span>]) % MOD
                           + <span class="hljs-number">1l</span>l * f[j + <span class="hljs-number">1</span>][e][<span class="hljs-number">1</span>] * (arr[j] &lt; arr[e]) % MOD) % MOD;
                f[j][e][<span class="hljs-number">1</span>] = (<span class="hljs-number">1l</span>l * f[j][e - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] * (arr[j] &lt; arr[e]) % MOD
                           + <span class="hljs-number">1l</span>l * f[j][e - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] * (arr[e - <span class="hljs-number">1</span>] &lt; arr[e]) % MOD) % MOD;
<span class="hljs-comment">//                printf(&quot;:f[%d][%d][0] = %d\n&quot;, j, e, f[j][e][0]);</span>
<span class="hljs-comment">//                printf(&quot;:f[%d][%d][1] = %d\n&quot;, j, e, f[j][e][1]);</span>
            &#125;
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, (f[<span class="hljs-number">1</span>][n][<span class="hljs-number">0</span>] + f[<span class="hljs-number">1</span>][n][<span class="hljs-number">1</span>]) % MOD);
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P4342-IOI1998-Polygon"><a href="#P4342-IOI1998-Polygon" class="headerlink" title="P4342 [IOI1998]Polygon"></a>P4342 [IOI1998]Polygon</h3><p>很好地一道区间dp，有负数的参与，不过无脑转移就可以了。</p>
<h4 id="状态设计-3"><a href="#状态设计-3" class="headerlink" title="状态设计"></a>状态设计</h4><p>先将原串复制一遍，然后<code>f[i][j]</code>表示从<code>i</code>至<code>j</code>能计算获得的最大值，<code>g[i][j]</code>表示从<code>i</code>至<code>j</code>能获得的最小值。</p>
<h4 id="转移方程-3"><a href="#转移方程-3" class="headerlink" title="转移方程"></a>转移方程</h4><p>复制后的串第<code>i</code>符号位表示为<code>flg[i]</code></p>
<script type="math/tex; mode=display">
1^{\circ}\quad 第i符号位为加号时
\left\{\begin{aligned}
f_{i,j}&=\max_{i\leq k<j}\left\{f_{i,k}+f_{k+1,j}\right\}\\
g_{i,j}&=\min_{i\leq k<j}\left\{g_{i,k}+g_{k+1,j}\right\}\\
\end{aligned}\right.\\
2^{\circ}\quad 第i符号位为乘号时
\left\{\begin{aligned}
f_{i,j}&=\max_{i\leq k<k}\left\{f_{i,k}*f_{k+1,j},\;f_{i,k}*g_{k+1,j},\;g_{i,k}*f_{k+1,j},\;g_{i,k}*g_{k+1,j}\right\}\\
g_{i,j}&=\min_{i\leq k<k}\left\{f_{i,k}*f_{k+1,j},\;f_{i,k}*g_{k+1,j},\;g_{i,k}*f_{k+1,j},\;g_{i,k}*g_{k+1,j}\right\}\\
\end{aligned}\right.</script><h4 id="AC代码-3"><a href="#AC代码-3" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;

<span class="hljs-keyword">int</span> n, arr[MAXN], flg[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXN], g[MAXN][MAXN];
<span class="hljs-keyword">int</span> ans;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-keyword">char</span> str[<span class="hljs-number">5</span>];
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, str + <span class="hljs-number">1</span>);
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[i]);
        arr[i + n] = arr[i];
        flg[i - <span class="hljs-number">1</span>] = flg[n + i - <span class="hljs-number">1</span>] = str[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;t&#x27;</span> ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<span class="hljs-comment">//0:+, 1:*</span>
    &#125;
<span class="hljs-comment">//    for(int i = 1; i &lt;= n + n; i++) printf(&quot;:%d %c\n&quot;, arr[i], flg[i] == 0 ? &#x27;+&#x27; : &#x27;*&#x27;);</span>
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0xf0</span>, <span class="hljs-keyword">sizeof</span>(f));
    <span class="hljs-built_in">memset</span>(g, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(g));
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n + n; i++) f[i][i] = g[i][i] = arr[i];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + l - <span class="hljs-number">1</span> &lt;= n + n; i++)&#123;
            <span class="hljs-keyword">int</span> j = i + l - <span class="hljs-number">1</span>;<span class="hljs-comment">// i to j</span>
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = i; k &lt;= j - <span class="hljs-number">1</span>; k++)&#123;<span class="hljs-comment">// (i, k) _ (k + 1, j)</span>
                <span class="hljs-keyword">if</span>(flg[k] == <span class="hljs-number">0</span>)&#123;
                    f[i][j] = max(f[i][j], f[i][k] + f[k + <span class="hljs-number">1</span>][j]);
                    g[i][j] = min(g[i][j], g[i][k] + g[k + <span class="hljs-number">1</span>][j]);
                &#125;<span class="hljs-keyword">else</span>&#123;
                    f[i][j] = max(f[i][j], max(max(
                              f[i][k] * f[k + <span class="hljs-number">1</span>][j], 
                              f[i][k] * g[k + <span class="hljs-number">1</span>][j]), max(
                              g[i][k] * f[k + <span class="hljs-number">1</span>][j],
                              g[i][k] * g[k + <span class="hljs-number">1</span>][j])));
                    g[i][j] = min(g[i][j], min(min(
                              f[i][k] * f[k + <span class="hljs-number">1</span>][j], 
                              f[i][k] * g[k + <span class="hljs-number">1</span>][j]), min(
                              g[i][k] * f[k + <span class="hljs-number">1</span>][j],
                              g[i][k] * g[k + <span class="hljs-number">1</span>][j])));
                &#125;
            &#125;
        &#125;
    &#125;
    ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        ans = max(ans, f[i][i + n - <span class="hljs-number">1</span>]);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-keyword">if</span>(f[i][i + n - <span class="hljs-number">1</span>] == ans)&#123;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, i);
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P4302-SCOI2003-字符串折叠"><a href="#P4302-SCOI2003-字符串折叠" class="headerlink" title="P4302 [SCOI2003]字符串折叠"></a>P4302 [SCOI2003]字符串折叠</h3><p>很好玩的区间dp，<del>竟然刷到了学长的题解</del>。</p>
<h4 id="状态设计-4"><a href="#状态设计-4" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j]</code>表示从<code>i</code>至<code>j</code>子串的最短折叠长度。</p>
<h4 id="转移方程-4"><a href="#转移方程-4" class="headerlink" title="转移方程"></a>转移方程</h4><p>我们设函数$f(S,len)$表示将字符串$S$划分成$\frac{\left|S\right|}{len}$段长度为$len$的相同子串时，其最短折叠长度。若无法分割，则返回<code>0x3f3f3f3f</code>。同时用$S_{i,j}$表示原串$S$中从$i$开始，到$j$结束所截的子串。</p>
<script type="math/tex; mode=display">
f_{i,j}=\min\left(
\min_{\left.k\middle|\left|S\right|\right.}\left\{f(S_{i,j},k)\right\},
\min_{i\leq k<j}\left\{f_{i,k}+f_{k,j}\right\}
\right)</script><h4 id="AC代码-4"><a href="#AC代码-4" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 0x3f3f3f3f</span>

<span class="hljs-keyword">int</span> n;
<span class="hljs-keyword">char</span> str[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXN];

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">calc</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> k)</span></span>&#123;
    <span class="hljs-keyword">if</span>((j - i + <span class="hljs-number">1</span>) % k != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> INF;
    <span class="hljs-keyword">int</span> parts = (j - i + <span class="hljs-number">1</span>) / k;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = i; p &lt;= i + k - <span class="hljs-number">1</span>; p++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> pt = k; p + pt &lt;= j; pt += k)&#123;
            <span class="hljs-keyword">if</span>(str[p + pt] != str[p]) <span class="hljs-keyword">return</span> INF;
        &#125;
    &#125;
    <span class="hljs-keyword">if</span>(parts == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> k;
    <span class="hljs-keyword">if</span>(parts &lt; <span class="hljs-number">10</span>) <span class="hljs-keyword">return</span> min(j - i + <span class="hljs-number">1</span>, f[i][i + k - <span class="hljs-number">1</span>] + <span class="hljs-number">2</span> + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span>(parts &lt; <span class="hljs-number">100</span>) <span class="hljs-keyword">return</span> f[i][i + k - <span class="hljs-number">1</span>] + <span class="hljs-number">2</span> + <span class="hljs-number">2</span>;
    <span class="hljs-keyword">return</span> f[i][i + k - <span class="hljs-number">1</span>] + <span class="hljs-number">2</span> + <span class="hljs-number">3</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, str + <span class="hljs-number">1</span>);
    n = <span class="hljs-built_in">strlen</span>(str + <span class="hljs-number">1</span>);
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(f));
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) f[i][i] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> l = <span class="hljs-number">2</span>; l &lt;= n; l++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + l - <span class="hljs-number">1</span> &lt;= n; i++)&#123;
            <span class="hljs-keyword">int</span> j = i + l - <span class="hljs-number">1</span>;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= l; k++)&#123;
                f[i][j] = min(f[i][j], calc(i, j, k));
            &#125;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = i; k &lt;= j - <span class="hljs-number">1</span>; k++)&#123;
                f[i][j] = min(f[i][j], f[i][k] + f[k + <span class="hljs-number">1</span>][j]);
            &#125;
<span class="hljs-comment">//            printf(&quot;:f[%d][%d] = %d\n&quot;, i, j, f[i][j]);</span>
        &#125;
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[<span class="hljs-number">1</span>][n]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P2470-SCOI2007-压缩"><a href="#P2470-SCOI2007-压缩" class="headerlink" title="P2470 [SCOI2007]压缩"></a>P2470 [SCOI2007]压缩</h3><p>详见<a target="_blank" rel="noopener" href="http://bluesnake.top/2020/10/12/%5BSCOI2007%5D%E5%8E%8B%E7%BC%A9/"><strong>该题的杂题报告</strong></a>。</p>
<h3 id="P1941-飞扬的小鸟"><a href="#P1941-飞扬的小鸟" class="headerlink" title="P1941 飞扬的小鸟"></a>P1941 飞扬的小鸟</h3><p>很有趣的一道题，将近花了一个小时才A的一道绿题，完美地向我们解释了什么叫做要维护内存安全。</p>
<h4 id="状态设计-5"><a href="#状态设计-5" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j]</code>表示鸟飞到<code>(i,j)</code>位置所需要的最小点击次数。</p>
<h4 id="转移方程-5"><a href="#转移方程-5" class="headerlink" title="转移方程"></a>转移方程</h4><p>记位置$i$的上升高度是$inc_{i}$，下降高度是$dec_{i}$</p>
<p>首先是向上飞行的dp转移式，在实际实现中需要用完全背包进行优化。</p>
<script type="math/tex; mode=display">
f_{i,j}=\min_{\;\;0<k<j\\\left.inc_{i-1}\middle|j-k\right.}\left\{
f_{i-1,k}+\frac{j-k}{inc_{i-1}}
\right\}</script><p>特别地，对于顶端$y=m$位置会顶头不会继续上升，需要在上面的基础上加上：</p>
<script type="math/tex; mode=display">
f_{i,m}=\min_{m-inc_{i-1}\leq k<m}\left\{f_{i,k}+1\right\}</script><p>然后是向下自然掉落的dp转移式：</p>
<script type="math/tex; mode=display">
f_{i,j}=f_{i-1,j+dec_{i-1}}\quad\cdots\cdots\quad\left[j+dec_{i-1}<m\right]</script><p>特别地，当该处有水管时，记水管低位置$l_i$，高位置$h_i$，存在最高优先级的赋值：</p>
<script type="math/tex; mode=display">
f_{i,k}=0\quad\cdots\cdots\quad k\in\left[1,j+dec_{i-1}\right]\cup\left[m-inc_{i-1},m\right]</script><h4 id="AC代码-5"><a href="#AC代码-5" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">10100</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXM = <span class="hljs-number">1100</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 0x3f3f3f3f</span>

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>&#123;</span>
    <span class="hljs-keyword">int</span> p, l, h;
    node(<span class="hljs-keyword">int</span> ap = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> al = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> ah = <span class="hljs-number">0</span>)&#123;
        p = ap; l = al; h = ah;
    &#125;
&#125;;

<span class="hljs-keyword">int</span> n, m, k;
<span class="hljs-keyword">int</span> incl[MAXN], decl[MAXN];
node arr[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXM];

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(node x, node y)</span></span>&#123;
    <span class="hljs-keyword">return</span> x.p &lt; y.p;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;k);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= n - <span class="hljs-number">1</span>; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;incl[i], &amp;decl[i]);
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;arr[i].p, &amp;arr[i].l, &amp;arr[i].h);
    &#125;
    sort(arr + <span class="hljs-number">1</span>, arr + k + <span class="hljs-number">1</span>, cmp);
<span class="hljs-comment">//    for(int i = 1; i &lt;= k; i++)&#123;</span>
<span class="hljs-comment">//        printf(&quot;:%d %d %d:\n&quot;, arr[i].p, arr[i].l, arr[i].h);</span>
<span class="hljs-comment">//    &#125;</span>
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(f));
    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = INF;
    <span class="hljs-keyword">int</span> anspass = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) f[<span class="hljs-number">0</span>][i] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">int</span> obs = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-keyword">while</span>(arr[obs].p &lt; i) obs++;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = incl[i - <span class="hljs-number">1</span>]; j &lt;= m; j++)&#123;
            f[i][j] = min(f[i][j], min(f[i - <span class="hljs-number">1</span>][j - incl[i - <span class="hljs-number">1</span>]], f[i][j - incl[i - <span class="hljs-number">1</span>]]) + <span class="hljs-number">1</span>);
        &#125;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = m - incl[i - <span class="hljs-number">1</span>]; j &lt;= m; j++)&#123;
            f[i][m] = min(f[i][m], min(f[i - <span class="hljs-number">1</span>][j], f[i][j]) + <span class="hljs-number">1</span>);
        &#125;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j + decl[i -  <span class="hljs-number">1</span>] &lt;= m; j++)&#123;
            f[i][j] = min(f[i][j], f[i - <span class="hljs-number">1</span>][j + decl[i - <span class="hljs-number">1</span>]]);
        &#125;
        f[i][<span class="hljs-number">0</span>] = INF;
<span class="hljs-comment">//        printf(&quot;::%d %d\n&quot;, arr[obs].p, obs);</span>
        <span class="hljs-keyword">if</span>(arr[obs].p == i)&#123;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= arr[obs].l; j++) f[i][j] = INF;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = arr[obs].h; j &lt;= m; j++) f[i][j] = INF;
            <span class="hljs-keyword">bool</span> flg = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++)&#123;
                <span class="hljs-keyword">if</span>(f[i][j] &lt; <span class="hljs-number">0x3f000000</span>)&#123;
                    flg = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                &#125;
            &#125;
            <span class="hljs-keyword">if</span>(flg) anspass++;
        &#125;
<span class="hljs-comment">//        for(int j = 1; j &lt;= m; j++)</span>
<span class="hljs-comment">//            printf(&quot;:f[%d][%d] = %d\n&quot;, i, j, f[i][j]);</span>
    &#125;
    <span class="hljs-keyword">int</span> ans = INF;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)&#123;
        ans = min(ans, f[n][i]);
    &#125;
    <span class="hljs-keyword">if</span>(ans &lt;= <span class="hljs-number">0x3f000000</span>)&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1\n%d\n&quot;</span>, ans);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    &#125;<span class="hljs-keyword">else</span>&#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0\n%d\n&quot;</span>, anspass);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P5020-货币系统"><a href="#P5020-货币系统" class="headerlink" title="P5020 货币系统"></a>P5020 货币系统</h3><p>很早就AC了，这里只贴出AC代码</p>
<h4 id="AC代码-6"><a href="#AC代码-6" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">25100</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXM = <span class="hljs-number">100</span>;

<span class="hljs-keyword">int</span> t, n, val[MAXN], ans, maximum;
<span class="hljs-keyword">bool</span> f[MAXN * MAXM];

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> &amp;y)</span></span>;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;t); <span class="hljs-keyword">while</span>(t--)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n); ans = n;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;val[i]),
            maximum = max(maximum, val[i]);
        sort(val + <span class="hljs-number">1</span>, val + n + <span class="hljs-number">1</span>, cmp);
        <span class="hljs-built_in">memset</span>(f, <span class="hljs-literal">false</span>, <span class="hljs-keyword">sizeof</span>(f));
        f[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
            <span class="hljs-keyword">if</span>(f[val[i]]) &#123;ans--; <span class="hljs-keyword">continue</span>;&#125;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = val[i]; j &lt;= maximum; j++)
                f[j] = f[j] | f[j - val[i]];
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> &amp;y)</span></span>&#123;
    <span class="hljs-keyword">return</span> x &lt; y;
&#125;</code></pre>
<h3 id="P1156-垃圾陷阱"><a href="#P1156-垃圾陷阱" class="headerlink" title="P1156 垃圾陷阱"></a>P1156 垃圾陷阱</h3><p>很经典的一道USACO的题目。</p>
<h4 id="状态设计-6"><a href="#状态设计-6" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j]</code>表示前<code>i</code>个垃圾，堆叠到了<code>j</code>高度所能存活到的最久时间。</p>
<h4 id="转移方程-6"><a href="#转移方程-6" class="headerlink" title="转移方程"></a>转移方程</h4><p>记垃圾出现时间为$t_i$，垃圾生命值$g_i$，垃圾高度$h_i$</p>
<p>采用递推式转移，转移前提是$f_{i,j}\geq t_{i+1}$，转移方程为：</p>
<script type="math/tex; mode=display">
\large{
\begin{aligned}
f_{i+1,j}&=f_{i,j}+g_{i+1}\\
f_{i+1,j+h_i}&=f_{i,j}
\end{aligned}
}</script><h4 id="AC代码-7"><a href="#AC代码-7" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXL = <span class="hljs-number">1100</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXH = <span class="hljs-number">110</span>;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>&#123;</span>
    <span class="hljs-keyword">int</span> t, f, h;
    node(<span class="hljs-keyword">int</span> at = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> af = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> ah = <span class="hljs-number">0</span>)&#123;
        t = at; f = af; h = ah;
    &#125;
&#125;;

<span class="hljs-keyword">int</span> d, n;
node arr[MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXH];<span class="hljs-comment">//高度堆到j的时候最多支撑生命 </span>

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> node &amp;x, <span class="hljs-keyword">const</span> node &amp;y)</span></span>&#123;
    <span class="hljs-keyword">return</span> x.t &lt; y.t;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;d, &amp;n);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;arr[i].t, &amp;arr[i].f, &amp;arr[i].h);
    &#125;
    sort(arr + <span class="hljs-number">1</span>, arr + n + <span class="hljs-number">1</span>, cmp);
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(f));
    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;
        ans = max(ans, f[i][<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= d; j++)&#123;
            <span class="hljs-keyword">if</span>(f[i][j] &lt; arr[i + <span class="hljs-number">1</span>].t)&#123;
                <span class="hljs-keyword">continue</span>;
            &#125;
            <span class="hljs-keyword">if</span>(j + arr[i + <span class="hljs-number">1</span>].h &gt;= d)&#123;
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, arr[i + <span class="hljs-number">1</span>].t);
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
            &#125;
            f[i + <span class="hljs-number">1</span>][j + arr[i + <span class="hljs-number">1</span>].h] = max(f[i + <span class="hljs-number">1</span>][j + arr[i + <span class="hljs-number">1</span>].h], f[i][j]);
            f[i + <span class="hljs-number">1</span>][j] = max(f[i + <span class="hljs-number">1</span>][j], f[i][j] + arr[i + <span class="hljs-number">1</span>].f);
        &#125;
    &#125;
    ans = max(ans, f[n][<span class="hljs-number">0</span>]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="P5322-BJOI2019-排兵布阵"><a href="#P5322-BJOI2019-排兵布阵" class="headerlink" title="P5322 [BJOI2019]排兵布阵"></a>P5322 [BJOI2019]排兵布阵</h3><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/user/115864">NaCly_Fish</a>大佬出的题，感觉好小清新呢。</p>
<h4 id="状态设计-7"><a href="#状态设计-7" class="headerlink" title="状态设计"></a>状态设计</h4><p>令<code>f[i][j]</code>表示前<code>i</code>个城堡，共派遣了<code>j</code>个士兵可能获得的最大值。</p>
<h4 id="转移方程-7"><a href="#转移方程-7" class="headerlink" title="转移方程"></a>转移方程</h4><p>令$a_{i,j}$表示第$i$个城堡，第$j$个对手派遣的士兵个数。</p>
<script type="math/tex; mode=display">
\large
f_{i,j}=\max_{\quad1\leq k\leq s\\j\geq 2\times a_{i,k}+1}\left\{f_{i-1,j-2\times a_{i,k}-1}+i\times k\right\}</script><h4 id="AC代码-8"><a href="#AC代码-8" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXS = <span class="hljs-number">110</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXM = <span class="hljs-number">20100</span>;

<span class="hljs-keyword">int</span> s, n, m;
<span class="hljs-keyword">int</span> arr[MAXS][MAXN];
<span class="hljs-keyword">int</span> f[MAXN][MAXM];

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>&#123;
    <span class="hljs-keyword">return</span> x &lt; y;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;s, &amp;n, &amp;m);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= s; i++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++)&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[j][i]);
        &#125;
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        sort(arr[i] + <span class="hljs-number">1</span>, arr[i] + s + <span class="hljs-number">1</span>, cmp);
    &#125;
<span class="hljs-comment">//    for(int i = 1; i &lt;= n; i++)&#123;</span>
<span class="hljs-comment">//        for(int j = 1; j &lt;= s; j++)&#123;</span>
<span class="hljs-comment">//            printf(&quot;:arr[%d][%d] = %d\n&quot;, i, j, arr[i][j]);</span>
<span class="hljs-comment">//        &#125;</span>
<span class="hljs-comment">//    &#125;</span>
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(f));
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++)&#123;
            f[i][j] = f[i - <span class="hljs-number">1</span>][j];
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= s; k++)&#123;
                <span class="hljs-keyword">if</span>(j - arr[i][k] - arr[i][k] - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>)&#123;
                    f[i][j] = max(f[i][j], f[i - <span class="hljs-number">1</span>][j - arr[i][k] - arr[i][k] - <span class="hljs-number">1</span>] + k * i);
<span class="hljs-comment">//                    printf(&quot;:%d %d %d %d\n&quot;, i, j, k, f[i][j]);</span>
                &#125;
            &#125;
<span class="hljs-comment">//            printf(&quot;f[%d][%d] = %d\n&quot;, i, j, f[i][j]);</span>
        &#125;
    &#125;
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= m; i++)
        ans = max(ans, f[n][i]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="CF730J-Bottles"><a href="#CF730J-Bottles" class="headerlink" title="CF730J Bottles"></a>CF730J Bottles</h3><p>因为一个极小值赋初值搞错了，浪费了大概半个小时。</p>
<p>首先答案$k$是很容易算出来的，只要贪心地取杯子就可以了。然后我们考虑让移动的水最少就是让保留在杯子里的水最多，所以题目转化为了一个双容量的01背包问题。</p>
<h4 id="状态设计-8"><a href="#状态设计-8" class="headerlink" title="状态设计"></a>状态设计</h4><p>我们定义<code>f[i][j][k]</code>表示为前<code>i</code>个水杯，使用了<code>j</code>个水杯，还剩下<code>k</code>的水需要有地方放的最小倒水花费，最终答案就是水的总数减去这个值。</p>
<h4 id="转移方程-8"><a href="#转移方程-8" class="headerlink" title="转移方程"></a>转移方程</h4><script type="math/tex; mode=display">
\Large
f_{i,j,k}=\max\left(f_{i-1,j,k},f_{i-1,j-1,k-b_{i}}+a_i\right)</script><h4 id="AC代码-9"><a href="#AC代码-9" class="headerlink" title="AC代码"></a>AC代码</h4><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">110</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXM = <span class="hljs-number">10100</span>;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>&#123;</span>
    <span class="hljs-keyword">int</span> a, b;
    node(<span class="hljs-keyword">int</span> aa = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> ab = <span class="hljs-number">0</span>)&#123;
        a = aa; b = ab;
    &#125;
&#125;;

<span class="hljs-keyword">int</span> n;
node arr[MAXN];
<span class="hljs-keyword">int</span> sumli, sumsz, ansk, tmps;
<span class="hljs-keyword">int</span> f[MAXN][MAXM];

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(node &amp;x, node &amp;y)</span></span>&#123;
    <span class="hljs-keyword">return</span> x.b &gt; y.b || x.b == y.b &amp;&amp; x.a &gt; y.a;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[i].a);
        sumli += arr[i].a;
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;arr[i].b);
    &#125;
    sort(arr + <span class="hljs-number">1</span>, arr + n + <span class="hljs-number">1</span>, cmp);
    ansk = <span class="hljs-number">0</span>;
    tmps = sumli;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-keyword">if</span>(tmps &gt; arr[i].b)&#123;
            tmps -= arr[i].b;
        &#125;<span class="hljs-keyword">else</span>&#123;
            ansk = i;
            <span class="hljs-keyword">break</span>;
        &#125;
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, ansk);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= ansk; i++) sumsz += arr[i].b;
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x80</span>, <span class="hljs-keyword">sizeof</span>(f));
    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = ansk; j &gt;= <span class="hljs-number">1</span>; j--)&#123;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = sumsz; k &gt;= arr[i].b; k--)&#123;
                f[j][k] = max(f[j][k], f[j - <span class="hljs-number">1</span>][k - arr[i].b] + arr[i].a);
            &#125;
        &#125;
    &#125;
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = sumli; i &lt;= sumsz; i++)&#123;
        ans = max(ans, f[ansk][i]);
    &#125;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, sumli - ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/OI%E7%9B%B8%E5%85%B3/">OI相关</a>
                    
                      <a class="hover-with-bg" href="/categories/OI%E7%9B%B8%E5%85%B3/%E9%A2%98%E5%8D%95%E5%81%9A%E9%A2%98%E6%8A%A5%E5%91%8A/">题单做题报告</a>
                    
                  </div>
                
                
              </div>
              
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  

  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "[动态规划] 提高组的dp问候&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 25,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "§"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>





  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script>

  
















<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
